<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MQTT FE Test</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
  <h2>MQTT Frontend Test</h2>

  <button onclick="sendMessage()">Gá»­i lá»‡nh</button>
  <div id="log"></div>

  <script>
    // Káº¿t ná»‘i Ä‘áº¿n Mosquitto qua WebSocket (cá»•ng 9001)
    const client = mqtt.connect("ws://localhost:9001");

    client.on("connect", function () {
      log("âœ… Káº¿t ná»‘i thÃ nh cÃ´ng MQTT broker!");
      client.subscribe("device/action", function (err) {
        if (!err) {
          log("ğŸ“© ÄÃ£ subscribe topic: device/action");
        }
      });
    });

    client.on("message", function (topic, message) {
      log("ğŸ“¥ Nháº­n Ä‘Æ°á»£c tá»« " + topic + ": " + message.toString());
    });

    function sendMessage() {
      client.publish("device/action", "ON");
      log("ğŸ“¤ Gá»­i lá»‡nh: ON");
    }

    function log(msg) {
      const logDiv = document.getElementById("log");
      logDiv.innerHTML += "<p>" + msg + "</p>";
    }
  </script>
</body>
</html>
